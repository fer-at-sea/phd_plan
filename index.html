<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.26">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Fer">

<title>Remote sensing of marine vegetation for monitoring and managing coastal ecosystems.</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="index_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="index_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-587c61ba64f3a5504c4d52d930310e48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="index_files/libs/quarto-diagram/mermaid.min.js"></script>
<script src="index_files/libs/quarto-diagram/mermaid-init.js"></script>
<link href="index_files/libs/quarto-diagram/mermaid.css" rel="stylesheet">


<link rel="stylesheet" href="assets/styles.css">
</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="3">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#research-plan" id="toc-research-plan" class="nav-link active" data-scroll-target="#research-plan">Research plan</a>
  <ul class="collapse">
  <li><a href="#abstract" id="toc-abstract" class="nav-link" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background">Background</a></li>
  <li><a href="#objectives" id="toc-objectives" class="nav-link" data-scroll-target="#objectives">Objectives</a></li>
  <li><a href="#methodology" id="toc-methodology" class="nav-link" data-scroll-target="#methodology">Methodology</a></li>
  <li><a href="#data-management-plan" id="toc-data-management-plan" class="nav-link" data-scroll-target="#data-management-plan">Data management plan</a></li>
  <li><a href="#timeline" id="toc-timeline" class="nav-link" data-scroll-target="#timeline">Timeline</a></li>
  </ul></li>
  <li><a href="#researcher-development-plan" id="toc-researcher-development-plan" class="nav-link" data-scroll-target="#researcher-development-plan">Researcher development plan</a></li>
  <li><a href="#bibliography" id="toc-bibliography" class="nav-link" data-scroll-target="#bibliography">Bibliography</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="../index.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li><li><a href="index.docx"><i class="bi bi-file-word"></i>MS Word</a></li></ul></div><div class="quarto-code-links"><h2>Code Links</h2><ul><li><a href="https://github.com/fer-at-sea"><i class="bi bi-file-code"></i>Github</a></li></ul></div></nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Remote sensing of marine vegetation for monitoring and managing coastal ecosystems.</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Fer </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="research-plan" class="level2">
<h2 class="anchored" data-anchor-id="research-plan">Research plan</h2>
<p><strong>PhD candidate</strong><br>
Fernando García-González <a href="https://orcid.org/0000-0003-4042-6789"><img src="https://orcid.org/sites/default/files/images/orcid_16x16.png" class="img-fluid" alt="ORCID"></a> <a href="mailto:f.garcia@ieo.csic.es"><img src="assets/img/img.png" class="img-fluid"></a> <a href="mailto:fergrc@hotmail.com"><img src="assets/img/img.png" class="img-fluid"></a> (<a href="https://coastal-ai.github.io/GEAM_GEODATABASE/">Seagrass Ecology Group, IEO-CSIC</a>)</p>
<p><strong>PhD directors</strong><br>
Jaime Bernardeau Esteller <a href="https://orcid.org/0000-0002-9290-0609"><img src="https://orcid.org/sites/default/files/images/orcid_16x16.png" class="img-fluid" alt="ORCID"></a> <a href="mailto:jaime.bernardeau@ieo.csic.es"><img src="assets/img/img.png" class="img-fluid"></a> (<a href="https://coastal-ai.github.io/GEAM_GEODATABASE/">Seagrass Ecology Group, IEO-CSIC</a>)<br>
Jordi Boada (CEAB-CSIC) <a href="https://orcid.org/0000-0002-3815-625X"><img src="https://orcid.org/sites/default/files/images/orcid_16x16.png" class="img-fluid" alt="ORCID"></a> <a href="mailto:jboada@ceab.csic.es"><img src="assets/img/img.png" class="img-fluid"></a> (<a href="https://www.ceab.csic.es/es/">CEAB-CSIC</a>)<br>
Pablo González-González <a href="https://orcid.org/0000-0002-9250-0920"><img src="https://orcid.org/sites/default/files/images/orcid_16x16.png" class="img-fluid" alt="ORCID"></a> <a href="mailto:gonzalezgpablo@uniovi.es"><img src="assets/img/img.png" class="img-fluid"></a> (<a href="https://www.aic.uniovi.es">AIC, Oviedo University</a>)</p>
<p><strong>Phd supervisor</strong><br>
Jana Verdura <a href="https://orcid.org/0000-0003-0662-1206"><img src="https://orcid.org/sites/default/files/images/orcid_16x16.png" class="img-fluid" alt="ORCID"></a> <a href="mailto:jana.verdura@udg.edu"><img src="assets/img/img.png" class="img-fluid"></a> (<a href="https://iea.udg.edu/grmar2022/">GR MAR, Girona University</a>)</p>
<p>&nbsp; &nbsp; &nbsp;</p>
<div class="text-center">
<p><img src="assets/img/logo_GEAM.png" class="img-fluid" width="80">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="assets/img/logo_IEO.png" class="img-fluid" width="80">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="assets/img/logo_CEAB.png" class="img-fluid" width="110">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="assets/img/logo_CSIC.png" class="img-fluid" width="100">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="assets/img/logo_uniovi.png" class="img-fluid" width="100">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="assets/img/logo_UdG.png" class="img-fluid" width="100"></p>
</div>
<p>&nbsp; &nbsp;</p>
<section id="abstract" class="level3">
<h3 class="anchored" data-anchor-id="abstract">Abstract</h3>
<p>Ocean environmental conditions are changing at unprecedented rates causing profound ecosystem transformations. These changes are especially important along the coast where intensifying human activity tends to concentrate. As a result, marine vegetated ecosystems are severely degrading and substantial areas of both seagrass meadows and macroalgal forests have already been lost. Since these are crucial foundation species fostering marine biodiversity and ecosystem functioning, important services to society are dissipating.</p>
<p>The challenge of reconciling development and conservation must be urgently addressed at the global scale. In this context, the European Union (EU) has implemented an ambitious <a href="https://research-and-innovation.ec.europa.eu/research-area/environment/oceans-and-seas/integrated-maritime-policy_en">Integrated Maritime Policy</a>, based on two main pillars: (i) the Marine Strategy Framework Directive (MSFD, 2008/56/EC), aimed at managing anthropogenic activities and achieving Good Environmental Status, and (ii) the Maritime Spatial Planning Framework Directive (MSPFD, 2014/89/EU). Within this ecosystem-based approach, the EU has also adopted the <a href="https://environment.ec.europa.eu/strategy/biodiversity-strategy-2030_en">European Biodiversity Strategy</a>, aligned with the objectives of the Convention on Biological Diversity, which focus on improving biodiversity and ecosystem services, maintaining ecological integrity and connectivity, and strengthening genetic diversity. In addition, other European directives and international agreements—such as the Habitats Directive (92/43/EEC), the Barcelona Convention, and OSPAR—aim to protect coastal marine ecosystems through habitat conservation, biodiversity protection, and the reduction of anthropogenic pressures.</p>
<p>Achieving these conservation goals requires robust, scientifically grounded methodologies for assessing the status of coastal ecosystems to guide decision making. A key component of these assessments is the ability to monitor habitat distribution periodically across multiple spatial scales, evaluating aspects such as range, extent, and the degree of fragmentation or connectivity. In this context, there is a clear trade-off between scale and accuracy. Traditional in situ distribution monitoring techniques provide high precision but are limited to small spatial scales. In contrast, the recent growth of remote sensing and geospatial data analysis offers considerable potential to address habitat distribution at broader scales.</p>
<p>The fundamental challenge lies in ensuring that cartographic products derived from remote sensors support solid scientific inference <span class="citation" data-cites="mcroberts_2011">(<a href="#ref-mcroberts_2011" role="doc-biblioref">McRoberts 2011</a>)</span> and align with the transdisciplinary knowledge required for effective environmental decision-making <span class="citation" data-cites="kilminster_2015">(<a href="#ref-kilminster_2015" role="doc-biblioref">Kilminster et al. 2015</a>)</span>. Achieving this requires a balance between in situ and ex situ information, and between technical and ecological knowledge: two sine qua non conditions for remote sensing to contribute effectively to conservation status assessment and coastal management.</p>
<p>The main objective of this research project is to <strong>leverage strong ecological expertise and long term in situ datasets to develop and test novel RS and geospatial methodologies for mapping and monitoring marine vegetated ecosystems in the intertidal and subtidal coastal zones</strong>. To achieve this, the potential of different RS platforms will be explored across <strong>two spatial scales</strong>. At the <strong>fine scale</strong>, underwater and aerial drones will be used to produce high-resolution maps, enabling the study of habitat spatial configuration, fragmentation and conservation status. At the <strong>broad scale</strong>, satellite imagery will be employed to generate maps of habitat distribution and to investigate temporal dynamics in habitat extent.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/img/scales.JPG" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>Interaction of the different observing scales.</figcaption>
</figure>
</div>
</section>
<section id="background" class="level3">
<h3 class="anchored" data-anchor-id="background">Background</h3>
<p>RS relies on the propagation of signals, optical or acoustic, between the target and the sensor enabling large-scale and long-term data collection. Instruments on satellites, aircrafts and submarines provide high-resolution imagery and measurements critical for monitoring environmental changes. These technologies have evolved from early aerial photography and low-resolution satellite sensors to the modern high-resolution, multispectral, and hyperspectral platforms allowing systematic data collection over extended areas and time periods and providing the foundation for Earth Observation.</p>
<p>Optical RS for coastal habitat mapping and monitoring is a fast evolving field with many advancements in the recent years, both in the <strong>intertidal</strong> <span class="citation" data-cites="calleja_2017 zoffoli_sentinel-2_2020 zoffoli_decadal_2021 zoffoli_remote_2022 davies_multi_2023 davies_sentinel_2024 davies_intertidal_2024 oiry_discriminating_2024 davies_initial_2026">(<a href="#ref-calleja_2017" role="doc-biblioref">Calleja et al. 2017</a>; <a href="#ref-zoffoli_sentinel-2_2020" role="doc-biblioref">Zoffoli et al. 2020</a>, <a href="#ref-zoffoli_decadal_2021" role="doc-biblioref">2021</a>, <a href="#ref-zoffoli_remote_2022" role="doc-biblioref">2022</a>; <a href="#ref-davies_multi_2023" role="doc-biblioref">Davies et al. 2023</a>, <a href="#ref-davies_sentinel_2024" role="doc-biblioref">2024a</a>, <a href="#ref-davies_intertidal_2024" role="doc-biblioref">2024b</a>, <a href="#ref-davies_initial_2026" role="doc-biblioref">2026</a>; <a href="#ref-oiry_discriminating_2024" role="doc-biblioref">Oiry et al. 2024</a>)</span> and <strong>subtidal</strong> zones <span class="citation" data-cites="fornes_mapping_2006 brando_physics_2009 traganos_mapping_2018 poursanidis_use_2019 traganos_spatially_2022">(<a href="#ref-fornes_mapping_2006" role="doc-biblioref">Fornes et al. 2006</a>; <a href="#ref-brando_physics_2009" role="doc-biblioref">Brando et al. 2009</a>; <a href="#ref-traganos_mapping_2018" role="doc-biblioref">Traganos and Reinartz 2018</a>; <a href="#ref-poursanidis_use_2019" role="doc-biblioref">Poursanidis et al. 2019</a>; <a href="#ref-traganos_spatially_2022" role="doc-biblioref">Traganos et al. 2022</a>)</span>. I personally developed my Master’s thesis <a href="https://dehesa.unex.es/entities/publication/a5f999ee-1419-41e2-ab14-e992a742bacd">Remote Sensing Applications in marine protected areas: using Sentinel-2 for satellite bathymetry estimation and benthic habitat mapping</a>, which, in 2021, was a pioneer work using Sentinel-2 in the Balearic Archipelago.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/img/img1.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption>Subtidal habitat mapping in Es Freus Marine Protected Area using Sentinel-2. Master’s thesis, 2021.</figcaption>
</figure>
</div>
<p>Using RS to map <strong>subtidal or underwater vegetation</strong> is inherently challenging because the water medium is highly absorbing. As a result, the electromagnetic signal that reaches the seabed and is reflected back to the sensor, the benthic reflectance, is largely restricted to the visible wavelengths (400-700 nm). This benthic reflectance varies spectrally with bottom composition and typically exhibits peaks and troughs related to pigments and other light absorbing, scattering and fluorescent features of the benthos. Together, these features form a spectral “fingerprint” characteristic of benthic constituent type, mixtures of constituents, pigment concentration, leaf area index, sediment grain size, and ecosystem condition. Moreover, subtidal mapping using <strong>aerial drones</strong> or <strong>satellites</strong> is restricted to the optically shallow waters, defined as regions where the bottom exerts a measurable influence on the water-leaving reflectance. Optically shallow waters are dependent on the bathymetry and the varying optical properties of both the water column and the benthos. Some of these limitations could be overcame through the use of <strong>underwater drones</strong> also called Underwater Autonomous Vehicles (AUVs), which operate closer to the seabed and are therefore able to more directly capture benthic reflectance, albeit at the cost of reduced spatial coverage.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/img/img2.png" class="img-fluid figure-img"></p>
<figcaption>Combination of satellite an AUV to monitor <em>P. oceanica</em> deep limit in the Tabarca Marine Protected Area. Full presentation available <a href="https://www.miteco.gob.es/content/dam/miteco/es/ceneam/grupos-de-trabajo-y-seminarios/patrimonio-natural/Garcia_Gonzalez_Fernando_2025_Nuevas_herramientas_seguimiento_marinas.pdf">here</a>.</figcaption>
</figure>
</div>
<p>Monitoring <strong>intertidal vegetation</strong> with RS also presents specific challenges. Although water absorption is not a limiting factor, intertidal environments are characterized by high spatial complexity and strong temporal variability driven by tides. As a result, analyses must rely on imagery acquired under low-tide conditions to ensure consistency. In this context, the combined use of <strong>aerial drones</strong> and <strong>satellites</strong> allows the complementary strengths of both platforms to be exploited, balancing drone spatial detail with satellite spatial coverage.</p>
<div class="text-center">
  <video width="70%" controls="">
    <source src="assets/img/video1.mov" type="video/quicktime">
    Your browser does not support the video tag.
  </video>
  <div>3D model of a cuvette. France, 2022. More models available <a href="https://sketchfab.com/fer-at-sea/models">here</a></div>
</div>
</section>
<section id="objectives" class="level3">
<h3 class="anchored" data-anchor-id="objectives">Objectives</h3>
<section id="main-phd-objective" class="level4">
<h4 class="anchored" data-anchor-id="main-phd-objective">Main phd objective:</h4>
<p><strong>Leverage strong ecological expertise and long term in situ datasets to develop and test novel RS and geospatial methodologies for mapping and monitoring marine vegetated ecosystems in the intertidal and subtidal coastal zones.</strong></p>
</section>
<section id="specific-objective-1-fine-scale-subtidal" class="level4">
<h4 class="anchored" data-anchor-id="specific-objective-1-fine-scale-subtidal">Specific objective 1: fine scale subtidal</h4>
<p>Explore the potential of integrating underwater photogrammetry, <strong>autonomous underwater vehicles</strong>, and advanced image analysis to overcome traditional limitations in <em>P. oceanica</em> deep-limit monitoring. Generating ultra-high resolution maps of the deep limits will allow for higher spatial precision, enabling the incorporation of landscape analysis to asses the structure and spatial configuration of the meadow limits. These seascape metrics offer a novel and promising perspective for assessing the condition of <em>P. oceanica</em> meadows at their deep limits, complementing traditional indicators.</p>
</section>
<section id="specific-objective-2-fine-scale-subtidal" class="level4">
<h4 class="anchored" data-anchor-id="specific-objective-2-fine-scale-subtidal">Specific objective 2: fine scale subtidal</h4>
<p>Develop a methodology, based on <strong>aerial drones</strong>, to asses underwater barren extensions caused by the overgrazing of herbivorous sea urchins <em>P. lividus</em> and <em>A. lixula</em>. Analyze temporal dynamics of barren expansion and contraction in relation to sea urchin harvesting.</p>
</section>
<section id="specific-objective-3-broad-scale-subtidal" class="level4">
<h4 class="anchored" data-anchor-id="specific-objective-3-broad-scale-subtidal">Specific objective 3: broad scale subtidal</h4>
<p>Use <strong>Sentinel-2</strong> to design a scalable and reproducible Python processing workflow to map underwater vegetation in Special Areas of Conservation (SAC) as defined by the Habitat Directive. Assess the spectral separability of different species and bottom types across different bioregions and develop a robust accuracy assessment methodology that can be applied to these RS-derived cartographies and other mapping products. Temporal trends in habitat distribution will also be analyzed for dynamic seagrass species <span class="citation" data-cites="kilminster_2015">(<a href="#ref-kilminster_2015" role="doc-biblioref">Kilminster et al. 2015</a>)</span>.</p>
</section>
<section id="specific-objective-4-broad-scale-intertidal" class="level4">
<h4 class="anchored" data-anchor-id="specific-objective-4-broad-scale-intertidal">Specific objective 4: broad scale intertidal</h4>
<p>Use <strong>Sentinel-2</strong> to design a scalable and reproducible Python processing workflow to study the temporal variability of <em>N. noltei</em> intertidal meadows in the north coast of Spain.</p>
</section>
</section>
<section id="methodology" class="level3">
<h3 class="anchored" data-anchor-id="methodology">Methodology</h3>
<p>The methodological framework is based on the integration of <strong>multi-platform remote sensing</strong> data acquired at different spatial and temporal scales <strong>with high quality field data</strong>. Ultra-high-resolution imagery obtained from autonomous underwater vehicles (AUVs) and aerial drones is first processed using photogrammetric workflows to generate georeferenced orthomosaics and three-dimensional products of the seabed and intertidal zones. These datasets provide detailed information on habitat structure and are used both for fine-scale mapping and as reference data for model calibration and validation. At broader scales, satellite imagery is processed through standardized pre-processing steps, including atmospheric and water-column corrections. Spectral, textural, and contextual features are then extracted from all platforms and harmonized within a common geospatial framework. Habitat mapping is performed using a combination of empirical classification approaches, physics-based models, and machine-learning techniques, producing probabilistic raster outputs that represent class membership or habitat probability. Finally, these probabilistic products are thresholded and post-processed to generate categorical habitat maps, whose accuracy and uncertainty are assessed using <strong>independent field observations</strong> and <strong>high-resolution reference data</strong>.</p>
<div class="text-center">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="assets/img/img3.png" class="img-fluid figure-img" style="width:90.0%"></p>
<figcaption>General workflow illustrating the transformation of imagery and ancillary variables within a datacube into probabilistic rasters and final categorical maps</figcaption>
</figure>
</div>
</div>
</section>
<section id="data-management-plan" class="level3">
<h3 class="anchored" data-anchor-id="data-management-plan">Data management plan</h3>
<section id="general-considerations" class="level4">
<h4 class="anchored" data-anchor-id="general-considerations">General considerations</h4>
<p>This project will leverage a unique, long-term dataset of seagrass and other marine vegetation observations collected over the past 20 years by the <strong>Seagrass Ecology Group (IEO-CSIC)</strong> and <strong>CEAB-CSIC</strong>. These in situ observations will serve to calibrate, validate, and interpret multi-temporal remote sensing products.</p>
<p>The research will integrate heterogeneous datasets including (i) long-term field observations (e.g.&nbsp;presence/absence, cover, depth limits, structural descriptors), (ii) ultra-high-resolution imagery derived from AUV and aerial drone surveys, and (iii) satellite-based remote sensing products. Newly generated datasets (orthomosaics, derived indices, probabilistic rasters, categorical habitat maps, and accuracy assessment outputs) will be produced following standardized and reproducible processing workflows, generating high-value datasets for coastal ecosystem monitoring, trend analysis, and future conservation efforts.</p>
</section>
<section id="fair-principles" class="level4">
<h4 class="anchored" data-anchor-id="fair-principles">FAIR Principles</h4>
<p><strong>Findable:</strong> Datasets will have persistent identifiers (DOIs) and standardized metadata (Darwin Core, ISO 19115/INSPIRE), including spatial/temporal coverage, provenance, and uncertainty.</p>
<p><strong>Accessible:</strong> Data will be openly available whenever possible through trusted repositories such as <strong>OBIS</strong>, <strong>EMODnet</strong>, <strong>Zenodo</strong>, or institutional data portals of IEO-CSIC, respecting embargo periods when required. Access conditions will be clearly stated, and data will be provided using open, non-proprietary formats (e.g.&nbsp;GeoTIFF, NetCDF, GeoPackage, CSV).</p>
<p><strong>Interoperable:</strong> Data will follow community standards, harmonized coordinate systems, and consistent variable naming and units to enable integration with long-term field observations.</p>
<p><strong>Reusable:</strong> Documentation will include data dictionaries, methodology, and quality-control procedures. Open licenses (CC BY/CC BY-NC) will facilitate reuse for monitoring, validation, and conservation planning.</p>
</section>
</section>
<section id="timeline" class="level3">
<h3 class="anchored" data-anchor-id="timeline">Timeline</h3>
<p>Having worked as a geospatial data analyst and research assistant for the past five years has paved the way for this PhD. Part of the proposed work will therefore build on and bring to completion ongoing and previously initiated studies. As a result, the timeline of the PhD is closely aligned with the continuation of my current work and research activities.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">gantt
    dateFormat  YYYY-MM-DD
    axisFormat  %Y
    section Year 1
    Literature review           :a1, 2026-01-01, 10M
    Methodology development     :b2, 2026-03-01, 14M
    Remote sensing analysis     :b1, 2026-03-01, 18M
    
    section Year 2
    Field campaigns &amp; sampling  :a2, 2027-01-01, 16M
    Manuscript drafting         :c2, 2027-09-01, 12M
    
    section Year 3
    Thesis writing              :d1, 2028-04-01, 8M
    Submission                  :d2, 2028-08-01, 6M
    Defense                     :d3, 2028-10-01, 6M
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
</section>
<section id="researcher-development-plan" class="level2">
<h2 class="anchored" data-anchor-id="researcher-development-plan">Researcher development plan</h2>
<section id="training-courses" class="level4">
<h4 class="anchored" data-anchor-id="training-courses">1. Training Courses</h4>
<ul>
<li>Attend workshops and training to strengthen technical expertise in remote sensing, geospatial data analysis, and deep learning, while also developing skills in coding, data management, FAIR principles, and reproducible research practices.</li>
<li>Potential courses are:
<ul>
<li>Experimental design and sampling, Girona University (1 ECTS)<br>
</li>
<li><a href="https://ioccg.org/what-we-do/training-and-education/ioccg-sls/">IOCCG Summer Lecture Series, Frontiers in Ocean Optics and Ocean Colour Science</a></li>
</ul></li>
</ul>
</section>
<section id="research-stays" class="level4">
<h4 class="anchored" data-anchor-id="research-stays">2. Research Stays</h4>
<ul>
<li>Erasmus Mobility: A 6-month research stay at an international partner institution is planned during the first year, ideally coinciding with methodology development and remote sensing analysis. This will allow exposure to complementary methodologies, strengthen collaborations, and expand the research network.</li>
</ul>
</section>
<section id="participation-as-attendee" class="level4">
<h4 class="anchored" data-anchor-id="participation-as-attendee">3. Participation as attendee:</h4>
<ul>
<li>Monthly group meetings and internal seminars.</li>
<li>Coordination meetings with public institutions.</li>
</ul>
</section>
<section id="participation-as-speaker" class="level4">
<h4 class="anchored" data-anchor-id="participation-as-speaker">4. Participation as speaker</h4>
<ul>
<li>Participation in at least one national or international conference per year is planned to present results, engage with the scientific community, and receive feedback.</li>
<li>Potential congresses are:
<ul>
<li><a href="https://aetcc2026.es">21st Congress of the Spanish Remote Sensing Association</a><br>
</li>
<li><a href="https://www.python.org/events/python-events/2147/">Geopython</a><br>
</li>
<li><a href="https://www.jornadassiglibre.org/ca/">Jornades SIG Lliure UdG</a></li>
<li><a href="https://www.osgeo.org/initiatives/foss4g/">FOSS4G (Free and Open Source Software for Geospatial)</a></li>
</ul></li>
</ul>
</section>
<section id="open-science-and-citizen-science-activities" class="level4">
<h4 class="anchored" data-anchor-id="open-science-and-citizen-science-activities">5. Open Science and Citizen Science Activities</h4>
<ul>
<li>Ensure all generated data and code follow <strong>FAIR principles</strong><br>
</li>
<li>Participation in public outreach:
<ul>
<li>Science week, Oceanographic Center of Gijón (2026, 2027, 2028)</li>
</ul></li>
</ul>
</section>
<section id="scientific-publications" class="level4">
<h4 class="anchored" data-anchor-id="scientific-publications">6. Scientific Publications</h4>
<ul>
<li>Target publications during PhD:
<ul>
<li><strong>Year 1:</strong> At least 1 research paper on the monitoring of <em>P. oceanica</em> deep limit using Autonomous Underwater Vehicles.</li>
<li><strong>Year 2:</strong> At least 1 research paper on the monitoring of underwater barrens using aerial drones.</li>
<li><strong>Year 3:</strong> At least 1 research paper on the use of Sentinel-2 to monitor underwater vegetation in marine protected areas.</li>
</ul></li>
<li>Consider submitting the thesis as a <strong>compilation of publications</strong></li>
</ul>
</section>
<section id="training-planning" class="level4">
<h4 class="anchored" data-anchor-id="training-planning">7. Training Planning</h4>
<table class="caption-top table">
<colgroup>
<col style="width: 33%">
<col style="width: 66%">
</colgroup>
<thead>
<tr class="header">
<th>Year</th>
<th>Activities</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2026</td>
<td>Transversal &amp; specific courses, literature review, remote sensing analyses, Erasmus stay (6 months), attendance at seminars and workshops</td>
</tr>
<tr class="even">
<td>2027</td>
<td>Field campaigns, remote sensing analyses, attendance &amp; presentations at conferences</td>
</tr>
<tr class="odd">
<td>2028</td>
<td>Data integration, thesis writing, manuscript drafting, oral presentations, open science dissemination, submission and defense of thesis</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="bibliography" class="level2 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">Bibliography</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-brando_physics_2009" class="csl-entry" role="listitem">
Brando, Vittorio E., Janet M. Anstee, Magnus Wettle, Arnold G. Dekker, Stuart R. Phinn, and Chris Roelfsema. 2009. <span>“A Physics Based Retrieval and Quality Assessment of Bathymetry from Suboptimal Hyperspectral Data.”</span> <em>Remote Sensing of Environment</em> 113 (4): 755–70. <a href="https://doi.org/10.1016/j.rse.2008.12.003">https://doi.org/10.1016/j.rse.2008.12.003</a>.
</div>
<div id="ref-calleja_2017" class="csl-entry" role="listitem">
Calleja, Felipe, Cristina Galván, Ana Silió-Calzada, José A. Juanes, and Bárbara Ondiviela. 2017. <span>“Long-Term Analysis of <span>Zostera</span> Noltei: <span>A</span> Retrospective Approach for Understanding Seagrasses’ Dynamics.”</span> <em>Marine Environmental Research</em> 130 (September): 93–105. <a href="https://doi.org/10.1016/j.marenvres.2017.07.017">https://doi.org/10.1016/j.marenvres.2017.07.017</a>.
</div>
<div id="ref-davies_multi_2023" class="csl-entry" role="listitem">
Davies, Bede Ffinian Rowe, Pierre Gernez, Andréa Geraud, Simon Oiry, Philippe Rosa, Maria Laura Zoffoli, and Laurent Barillé. 2023. <span>“Multi- and Hyperspectral Classification of Soft-Bottom Intertidal Vegetation Using a Spectral Library for Coastal Biodiversity Remote Sensing.”</span> <em>Remote Sensing of Environment</em> 290 (May): 113554. <a href="https://doi.org/10.1016/j.rse.2023.113554">https://doi.org/10.1016/j.rse.2023.113554</a>.
</div>
<div id="ref-davies_initial_2026" class="csl-entry" role="listitem">
Davies, Bede Ffinian Rowe, Simon Oiry, Mar Roca, Philippe Rosa, Maria Laura Zoffoli, Dimitris Poursanidis, Tobias Dolch, et al. 2026. <span>“An Initial Map of <span>European</span> Intertidal Seagrass.”</span> <em>Remote Sensing of Environment</em> 333 (January): 115116. <a href="https://doi.org/10.1016/j.rse.2025.115116">https://doi.org/10.1016/j.rse.2025.115116</a>.
</div>
<div id="ref-davies_sentinel_2024" class="csl-entry" role="listitem">
Davies, Bede Ffinian Rowe, Simon Oiry, Philippe Rosa, Maria Laura Zoffoli, Ana I. Sousa, Oliver R. Thomas, Dan A. Smale, et al. 2024a. <span>“A Sentinel Watching over Inter-Tidal Seagrass Phenology Across <span>Western</span> <span>Europe</span> and <span>North</span> <span>Africa</span>.”</span> <em>Communications Earth &amp; Environment</em> 5 (1): 382. <a href="https://doi.org/10.1038/s43247-024-01543-z">https://doi.org/10.1038/s43247-024-01543-z</a>.
</div>
<div id="ref-davies_intertidal_2024" class="csl-entry" role="listitem">
———, et al. 2024b. <span>“Intertidal Seagrass Extent from <span>Sentinel</span>-2 Time-Series Show Distinct Trajectories in <span>Western</span> <span>Europe</span>.”</span> <em>Remote Sensing of Environment</em> 312 (October): 114340. <a href="https://doi.org/10.1016/j.rse.2024.114340">https://doi.org/10.1016/j.rse.2024.114340</a>.
</div>
<div id="ref-fornes_mapping_2006" class="csl-entry" role="listitem">
Fornes, A., G. Basterretxea, A. Orfila, A. Jordi, A. Alvarez, and J. Tintore. 2006. <span>“Mapping <span>Posidonia</span> Oceanica from <span>IKONOS</span>.”</span> <em>ISPRS Journal of Photogrammetry and Remote Sensing</em> 60 (5): 315–22. <a href="https://doi.org/10.1016/j.isprsjprs.2006.04.002">https://doi.org/10.1016/j.isprsjprs.2006.04.002</a>.
</div>
<div id="ref-kilminster_2015" class="csl-entry" role="listitem">
Kilminster, Kieryn, Kathryn McMahon, Michelle Waycott, Gary A. Kendrick, Peter Scanes, Len McKenzie, Katherine R. O’Brien, et al. 2015. <span>“Unravelling Complexity in Seagrass Systems for Management: <span>Australia</span> as a Microcosm.”</span> <em>Science of The Total Environment</em> 534 (November): 97–109. <a href="https://doi.org/10.1016/j.scitotenv.2015.04.061">https://doi.org/10.1016/j.scitotenv.2015.04.061</a>.
</div>
<div id="ref-mcroberts_2011" class="csl-entry" role="listitem">
McRoberts, Ronald E. 2011. <span>“Satellite Image-Based Maps: <span>Scientific</span> Inference or Pretty Pictures?”</span> <em>Remote Sensing of Environment</em> 115 (2): 715–24. <a href="https://doi.org/10.1016/j.rse.2010.10.013">https://doi.org/10.1016/j.rse.2010.10.013</a>.
</div>
<div id="ref-oiry_discriminating_2024" class="csl-entry" role="listitem">
Oiry, Simon, Bede Ffinian Rowe Davies, Ana I. Sousa, Philippe Rosa, Maria Laura Zoffoli, Guillaume Brunier, Pierre Gernez, and Laurent Barillé. 2024. <span>“Discriminating <span>Seagrasses</span> from <span>Green</span> <span>Macroalgae</span> in <span>European</span> <span>Intertidal</span> <span>Areas</span> <span>Using</span> <span>High</span>-<span>Resolution</span> <span>Multispectral</span> <span>Drone</span> <span>Imagery</span>.”</span> <em>Remote Sensing</em> 16 (23): 4383. <a href="https://doi.org/10.3390/rs16234383">https://doi.org/10.3390/rs16234383</a>.
</div>
<div id="ref-poursanidis_use_2019" class="csl-entry" role="listitem">
Poursanidis, Dimitris, Dimosthenis Traganos, Peter Reinartz, and Nektarios Chrysoulakis. 2019. <span>“On the Use of <span>Sentinel</span>-2 for Coastal Habitat Mapping and Satellite-Derived Bathymetry Estimation Using Downscaled Coastal Aerosol Band.”</span> <em>International Journal of Applied Earth Observation and Geoinformation</em> 80 (August): 58–70. <a href="https://doi.org/10.1016/j.jag.2019.03.012">https://doi.org/10.1016/j.jag.2019.03.012</a>.
</div>
<div id="ref-traganos_spatially_2022" class="csl-entry" role="listitem">
Traganos, Dimosthenis, Chengfa Benjamin Lee, Alina Blume, Dimitris Poursanidis, Hrvoje Čižmek, Julie Deter, Vesna Mačić, et al. 2022. <span>“Spatially <span>Explicit</span> <span>Seagrass</span> <span>Extent</span> <span>Mapping</span> <span>Across</span> the <span>Entire</span> <span>Mediterranean</span>.”</span> <em>Frontiers in Marine Science</em> 9 (July): 871799. <a href="https://doi.org/10.3389/fmars.2022.871799">https://doi.org/10.3389/fmars.2022.871799</a>.
</div>
<div id="ref-traganos_mapping_2018" class="csl-entry" role="listitem">
Traganos, Dimosthenis, and Peter Reinartz. 2018. <span>“Mapping <span>Mediterranean</span> Seagrasses with <span>Sentinel</span>-2 Imagery.”</span> <em>Marine Pollution Bulletin</em> 134 (September): 197–209. <a href="https://doi.org/10.1016/j.marpolbul.2017.06.075">https://doi.org/10.1016/j.marpolbul.2017.06.075</a>.
</div>
<div id="ref-zoffoli_decadal_2021" class="csl-entry" role="listitem">
Zoffoli, Maria Laura, Pierre Gernez, Laurent Godet, Steef Peters, Simon Oiry, and Laurent Barillé. 2021. <span>“Decadal Increase in the Ecological Status of a <span>North</span>-<span>Atlantic</span> Intertidal Seagrass Meadow Observed with Multi-Mission Satellite Time-Series.”</span> <em>Ecological Indicators</em> 130 (November): 108033. <a href="https://doi.org/10.1016/j.ecolind.2021.108033">https://doi.org/10.1016/j.ecolind.2021.108033</a>.
</div>
<div id="ref-zoffoli_remote_2022" class="csl-entry" role="listitem">
Zoffoli, Maria Laura, Pierre Gernez, Simon Oiry, Laurent Godet, Sébastien Dalloyau, Bede Ffinian Rowe Davies, and Laurent Barillé. 2022. <span>“Remote Sensing in Seagrass Ecology: Coupled Dynamics Between Migratory Herbivorous Birds and Intertidal Meadows Observed by Satellite During Four Decades.”</span> Edited by Kylie Scales and Alice Jones. <em>Remote Sensing in Ecology and Conservation</em>, December, rse2.319. <a href="https://doi.org/10.1002/rse2.319">https://doi.org/10.1002/rse2.319</a>.
</div>
<div id="ref-zoffoli_sentinel-2_2020" class="csl-entry" role="listitem">
Zoffoli, Maria Laura, Pierre Gernez, Philippe Rosa, Anthony Le Bris, Vittorio E. Brando, Anne-Laure Barillé, Nicolas Harin, et al. 2020. <span>“Sentinel-2 Remote Sensing of <span>Zostera</span> Noltei-Dominated Intertidal Seagrass Meadows.”</span> <em>Remote Sensing of Environment</em> 251 (December): 112020. <a href="https://doi.org/10.1016/j.rse.2020.112020">https://doi.org/10.1016/j.rse.2020.112020</a>.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>